file:
  /etc/resolv.conf:
    exists: true
    contains:
      - nameserver 127.0.0.1

  /etc/network/interfaces:
    exists: true
    contains:
      - # ensure to source all other interfaces
      - source /etc/network/interfaces.d/*

  /etc/network/interfaces.d/swarm:
    exists: true
    contains:
      - auto swarm
      - iface swarm inet static

  /etc/systemd/system/dnsmasq.service:
    exists: false

  /etc/systemd/system/dnsmasq@.service:
    exists: true

  /etc/dnsmasq.d/proxy.conf:
    exists: true
    contains:
      - interface=lo
      - server=/#/8.8.8.8

  /etc/dnsmasq.d/swarm.conf:
    exists: true
    contains:
      - interface=swarm
      - domain=swarm
      - server=/swarm/10.100.0.1
      - server=/#/8.8.8.8

package:
  dnsmasq:
    installed: true

service:
  dnsmasq:
    enabled: false
    running: false

  dnsmasq@proxy:
    enabled: true
    running: true

  dnsmasq@swarm:
    enabled: true
    running: true
